# Zen - Horse Race Prediction By ML.NET - 競馬予測システム開発プロジェクト

## 1. プロジェクト概要
機械学習を用いた競馬予測システムを構築するプロジェクト。
情報源はWebスクレイピングにより取得し、機械学習モデルで予測を行う。
予測結果はWebインターフェースを通じてスマートフォン等で閲覧可能にする。

## 2. コア方針
*   **言語選定**: Pythonではなく、**C# (.NET)** を採用する。
*   **インフラ**: Linuxマシンでの運用を前提とする（Docker活用の可能性大）。
*   **AIとの協働**: 実装、設計、ドキュメント作成においてAIアシスタントを積極的に活用する。
*   **マナー**: スクレイピング対象サイト（netkeiba.com等）のマナーと規約を最大限尊重する。

## 3. 技術スタック (予定)
*   **開発言語**: C# (.NET 10)
*   **フレームワーク**: ASP.NET Core Web API
*   **機械学習**: ML.NET
*   **データ収集 (Scraping)**: Playwright for .NET / AngleSharp
*   **データアクセス**: Entity Framework Core (Code First)
*   **データベース**: PostgreSQL または SQLite
*   **ジョブ管理**: Quartz.NET / Hangfire / System.Threading.Channels
*   **コンテナ**: Docker

## 4. アーキテクチャ戦略

### 4.1 データ収集と予測フロー
「ハイブリッド構成」を採用し、応答性とデータの網羅性を両立する。

1.  **事前蓄積 (Base Data)**
    *   過去数年分のレース結果、競走馬、騎手データを定期バッチで収集・DB保存。
    *   netkeiba等のID体系をキーとして管理する。
2.  **オンデマンド収集 (Target Data)**
    *   ユーザーがレースを指定したタイミングで実行。
    *   「そのレースの出馬表」と「DBに不足している差分データ」のみを収集し、待ち時間を最小化する。
3.  **非同期予測処理**
    *   Web APIでリクエストを受け付け、「受付完了」を即座に返す。
    *   バックグラウンドで収集・推論を行い、結果をDBに保存する。

### 4.2 ソリューション構成 (ZenMLRace.sln)
責務を明確に分離するため、以下のプロジェクト構成とする。

1.  **`ZenMLRace.Core`** (Class Library)
    *   ドメイン層。エンティティ定義、インターフェース、共通DTO。
2.  **`ZenMLRace.Infrastructure`** (Class Library)
    *   データアクセス (EF Core)、スクレイピング実装。
3.  **`ZenMLRace.ML`** (Class Library)
    *   機械学習ロジック、モデル定義、推論エンジン。
4.  **`ZenMLRace.Worker`** (Worker Service)
    *   バックグラウンド処理。定期バッチおよび予測ジョブの実行。
5.  **`ZenMLRace.API`** (ASP.NET Core Web API)
    *   システムの入り口。REST API提供、認証、ジョブ投入。
    *   フロントエンドは特定技術に依存せず、APIと疎結合にする。

## 5. 開発ルール・制約
*   **コミュニケーション**: 回答は事実に根ざし、中立的に行うこと。
*   **言語**: 日本語を使用する。
*   **ベストプラクティスの検証**: ソースコードなどを出力する場合、それが一般的なベストプラクティスやコード規約に則っているか留意する
    *   `.editorconfig`も参照すること
